.ORIG x3000
TRAP x29
ADD R3, R0, #-1
ADD R4, R2, #-1
LD R6, TARGET_HEIGHT

OUTER_LOOP
ADD R5, R4, #0

INNER_LOOP
TRAP x2D

NOT R7, R6
ADD R7, R7, #1
ADD R7, R1, R7
BRzp BUILD_BLOCK

LD R7, AIR_BLOCK_ID
TRAP x2C
BR CONTINUE_Z

BUILD_BLOCK
LD R7, COBBLESTONE_BLOCK_ID
TRAP x2C

CONTINUE_Z
ADD R5, R5, #1
ADD R7, R5, #-3
BRn INNER_LOOP

ADD R3, R3, #1
ADD R7, R3, #-3
BRn OUTER_LOOP

HALT

COBBLESTONE_BLOCK_ID .FILL #4
AIR_BLOCK_ID         .FILL #0
TARGET_HEIGHT        .FILL #5
.END
