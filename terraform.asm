.ORIG x3000
LEA R6, xFF
AND R0, R0, #0
AND R1, R1, #0
AND R2, R2, #0
TRAP 0x29
TRAP 0x2D
ADD R1, R1, #1
ADD R5, R1, #0
ADD R0, R0, #1
ADD R2, R2, #1
JSR REMOVEANDFILL
ADD R0, R0, #-1
JSR REMOVEANDFILL
ADD R0, R0, #-1
JSR REMOVEANDFILL
ADD R2, R2, #-1
JSR REMOVEANDFILL
ADD R2, R2, #-1
JSR REMOVEANDFILL
ADD R0, R0, #1
JSR REMOVEANDFILL
ADD R0, R0, #1
JSR REMOVEANDFILL
ADD R2, R2, #1
JSR REMOVEANDFILL
AND R0, R0, #0
AND R1, R1, #0
AND R2, R2, #0
AND R3, R3, #0
AND R4, R4, #0
AND R5, R5, #0
AND R6, R6, #0
AND R7, R7, #0
HALT

REMOVEANDFILL
AND R3, R3, #0
AND R6, R6, #0
NOT R3, R5
TRAP 0x2D
ADD R1, R1, #1
AND R4, R4, #0
ADD R4, R1, R3
ADD R4, R4, #1
BRnz FILL
TRAP 0x2D
ADD R1, R1, #1
AND R3, R3, #0
ADD R6, R4, #0
LOOP
BRn CUTTER
TRAP 0x2C
ADD R1, R1, #-1
ADD R6, R6, #-1
BR LOOP

CUTTER
AND R6, R6, #0

FILL
ADD R4, R4, #0
BRzp CUT
TRAP 0x2D
ADD R1, R1, #1
AND R3, R3, #0
ADD R3, R3, #4
NOT R4, R4
ADD R4, R4, #1
ADD R6, R4, #0
LOOP2
BRnz FILLER
TRAP 0x2C
ADD R1, R1, #1
ADD R6, R6, #-1
BR LOOP2

FILLER
AND R6, R6, #0

CUT
AND R1, R1, #0
ADD R1, R5, #0
AND R4, R4, #0
AND R6, R6, #0
AND R3, R3, #0
ADD R3, R3, #0
NOT R6, R1
ADD R6, R6, #1
ADD R1, R1, #0
BRzp NEGATIVE
AND R1, R1, #0
TRAP 0x2D
NOT R4, R1
ADD R4, R4, #1
ADD R4, R4, R5
BRn NEGATIVEFILLER
AND R4, R4, #0
AND R1, R1, #0
ADD R6, R6, #0
LOOP3
BRnz NCUTTER
TRAP 0x2C
ADD R1, R1, #-1
ADD R6, R6, #-1
BR LOOP3

NCUTTER
AND R1, R1, #0

NEGATIVE
AND R1, R1, #0
BR END1

NEGATIVEFILLER
ADD R3, R3, #4
ADD R4, R4, #0
LOOP4
BRnz NFILLER
TRAP 0x2C
ADD R1, R1, #1
ADD R4, R4, #-1
BR LOOP4

NFILLER
AND R3, R3, #0

END1
AND R1, R1, #0
ADD R1, R5, #0
AND R4, R4, #0
AND R6, R6, #0
AND R3, R3, #0
RET
.END
